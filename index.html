<!DOCTYPE html>
<html lang="ur">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eid-ul-Adha Mubarak Wishes</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Merriweather', serif;
            text-align: center;
            background-color: #fffaf0;
            margin: 0;
            padding: 20px 5px;
            color: #333;
        }

        .container {
            background-color: #fffaf0;
            padding: 15px;
            border-radius: 10px;
            max-width: 500px;
            width: 100%;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .image-card {
            border: 5px solid #DAA520;
            border-radius: 15px;
            padding: 5px;
            background-color: #000;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        img#eidGif {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            display: block;
        }

        .countdown-timer {
            font-size: 1.5em;
            color: #d82d8c;
            margin-top: 15px;
            margin-bottom: 25px;
            font-weight: bold;
            font-family: 'Merriweather', serif;
        }

        .greeting {
            font-family: 'Cinzel Decorative', cursive;
            font-size: 1.8em;
            color: #8B4513;
            margin-bottom: 25px;
            font-weight: bold;
            line-height: 1.4;
            animation: pulseGreeting 3s infinite ease-in-out;
        }

        @keyframes pulseGreeting {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }

        hr {
            border: 0;
            height: 1px;
            background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(218, 165, 32, 0.75), rgba(0, 0, 0, 0));
            margin: 30px 0;
        }
        
        .form-section p {
            font-family: 'Merriweather', serif;
            font-size: 1.1em;
            color: #555;
            margin-bottom: 15px;
        }

        input[type="text"] {
            width: calc(100% - 24px);
            padding: 12px;
            margin-bottom: 20px;
            border: 2px solid #DAA520;
            border-radius: 8px;
            font-size: 1.1em;
            font-family: 'Merriweather', serif;
        }

        button.main-action-btn {
            background: linear-gradient(45deg, #28a745, #218838);
            color: white;
            padding: 14px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.15em;
            font-family: 'Merriweather', serif;
            font-weight: bold;
            transition: transform 0.2s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            max-width: 300px;
            margin: 5px auto 20px;
        }
        
        button.main-action-btn:hover {
            transform: scale(1.05);
        }

        .main-action-btn svg {
            width: 24px;
            height: 24px;
        }
        
        #generatedLinkContainer {
            margin-top: 25px;
            word-wrap: break-word;
            background-color: #f0fff0;
            padding: 15px;
            border-radius: 8px;
            border: 1px dashed #28a745;
        }

        #generatedLinkContainer p { font-size: 1em; color: #333; margin-bottom: 8px; }
        #generatedLink { font-weight: bold; color: #007bff; display: block; margin-bottom: 10px; direction: ltr; padding: 8px; background-color: #e9ecef; border-radius: 4px; font-size: 0.95em; }
        #generatedLinkContainer .action-buttons button { padding: 8px 15px; font-size: 0.9em; margin: 5px 3px; border-radius: 5px; color: white; cursor: pointer; border: none; }
        #generatedLinkContainer .action-buttons button.copy-btn { background-color: #DAA520; }
        #generatedLinkContainer .action-buttons button.share-btn { background-color: #17a2b8; }
        
        .visitor-info {
            margin-top: 30px;
            padding-top: 20px;
            font-size: 1em;
            color: #444;
            font-family: 'Merriweather', serif;
        }

        .visitor-info p { margin: 8px 0; }
        .visitor-list { max-height: 80px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; margin-top: 8px; text-align: left; font-size: 0.9em; background-color: #f8f8f8; border-radius: 5px; }

    </style>
</head>
<body>

    <div class="container">

        <div class="image-card">
            <img id="eidGif" src="https://i.ibb.co/3s6Kk3w/eid-ul-adha.gif" alt="Eid Mubarak Animation" loading="lazy" decoding="async">
        </div>

        <div id="countdown" class="countdown-timer">
            Eid Mubarak in: <br> 0d 11h 50m 39s
        </div>

        <div id="greetingMessage" class="greeting">
            SHAHIN KI TARAF SE AAPKO BOHAT BOHAT EID MUBARAK!
        </div>
        
        <hr>

        <div class="form-section">
            <p><strong>Apna naam likhein aur doston ke saath share karein:</strong></p>
            <input type="text" id="nameInput" placeholder="Yahan apna naam likhein">

            <button onclick="generateLink()" class="main-action-btn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" fill="currentColor">
                    <path d="M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zM223.9 439.6c-38.2 0-73.7-14.7-101.6-40.4l-7.1-4.2-75.8 19.9L53.9 398l-4.4-7.3c-18.5-30.7-29.9-65.7-29.9-102.7 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5c-.1 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"/>
                </svg>
                <span>Create & Share on WhatsApp</span>
            </button>
        </div>

        <div id="generatedLinkContainer" style="display:none;">
            <p>Aapka link tayyar hai:</p>
            <span id="generatedLink"></span>
            <div class="action-buttons">
                <button onclick="copyLink()" class="copy-btn">Copy Karein</button>
                <button onclick="shareOnOtherApps()" class="share-btn">Aur Apps Par Share Karein</button>
            </div>
        </div>

        <div class="visitor-info">
            <p><strong>Link Creation Stats:</strong></p>
            <p>Total creators (this browser): <span id="visitorCount">4</span></p>
            <p>Names of creators (this browser):</p>
            <div id="visitorList" class="visitor-list">
                <p style="margin: 2px 0;">Shahin</p>
                <p style="margin: 2px 0;">Shahin Mangral</p>
            </div>
        </div>

    </div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // --- THIS IS THE FIX ---
        // The form to create a wish is now ALWAYS visible.
        // We only change the greeting text if a sender's name is in the URL.

        const urlParams = new URLSearchParams(window.location.search);
        const sender = urlParams.get('sender');
        const greetingMessageEl = document.getElementById('greetingMessage');

        if (sender) {
            // If a sender's name exists, show a personalized greeting from them.
            const decodedSender = decodeURIComponent(sender);
            greetingMessageEl.innerHTML = `${decodedSender} KI TARAF SE <br> AAPKO BOHAT BOHAT <br> EID MUBARAK!`;
            document.title = `A wish from ${decodedSender}`;
        } else {
            // Otherwise, show the default greeting from the image.
             greetingMessageEl.innerHTML = `SHAHIN KI TARAF SE <br> AAPKO BOHAT BOHAT <br> EID MUBARAK!`;
             document.title = "Eid-ul-Adha Mubarak!";
        }
        
        // The rest of your functionalities remain the same
        updateCountdown();
        setInterval(updateCountdown, 1000);
        updateVisitorDisplay();
    });

    function updateCountdown() {
        // This is a placeholder date. Change it to the correct Eid date.
        const eidDate = new Date("June 17, 2024 00:00:00").getTime();
        const now = new Date().getTime();
        const distance = eidDate - now;
        const countdownElement = document.getElementById("countdown");

        if (distance < 0) {
            countdownElement.innerHTML = "Eid Mubarak!";
            return;
        }

        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);

        countdownElement.innerHTML = `Eid Mubarak in: <br> ${days}d ${hours}h ${minutes}m ${seconds}s`;
    }

    function generateLink() {
        const nameInput = document.getElementById('nameInput');
        const name = nameInput.value.trim();
        if (name === "") {
            alert("Please apna naam likhein!");
            return;
        }

        const encodedName = encodeURIComponent(name);
        const baseUrl = window.location.origin + window.location.pathname;
        const newLink = `${baseUrl}?sender=${encodedName}`;

        // Show the generated link and copy/share buttons
        const generatedLinkEl = document.getElementById('generatedLink');
        generatedLinkEl.textContent = newLink;
        document.getElementById('generatedLinkContainer').style.display = 'block';
        
        // Save creator name and update display
        addCreator(name);
        updateVisitorDisplay();

        // Automatically prepare WhatsApp message
        const shareTextBody = `${name} ki taraf se aapko Eid-ul-Adha bohat bohat Mubarak! 🐑🐄🐪\nMera special Eid card dekhein aur aap bhi apna banayein:`;
        const fullMessageForWhatsApp = `${shareTextBody} ${newLink}`;
        const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(fullMessageForWhatsApp)}`;
        window.open(whatsappUrl, '_blank');
    }

    function copyLink() {
        const linkText = document.getElementById('generatedLink').textContent;
        navigator.clipboard.writeText(linkText).then(() => {
            alert('Link copy ho gaya!');
        }).catch(err => {
            alert('Link copy nahi ho saka. Please manual copy karein.');
        });
    }

    function shareOnOtherApps() {
        const linkToShare = document.getElementById('generatedLink').textContent;
        const name = document.getElementById('nameInput').value.trim() || 'A Friend';
        const shareTitle = `Eid-ul-Adha Mubarak from ${name}!`;
        const shareTextBody = `${name} ki taraf se aapko Eid-ul-Adha bohat bohat Mubarak! 🐑🐄🐪\nMera special Eid card dekhein aur aap bhi apna banayein:`;
        
        if (navigator.share) {
            navigator.share({
                title: shareTitle,
                text: shareTextBody,
                url: linkToShare,
            }).catch(error => console.log('Error sharing:', error));
        } else {
            alert("Aapka browser native sharing support nahi karta. Link copy karke share karein.");
            copyLink();
        }
    }

    // Functions to manage creators list in local storage
    function getCreators() {
        const creatorsJSON = localStorage.getItem('eidAdhaCreators');
        return creatorsJSON ? JSON.parse(creatorsJSON) : [];
    }

    function addCreator(name) {
        let creators = getCreators();
        if (!creators.includes(name)) {
            creators.push(name);
            localStorage.setItem('eidAdhaCreators', JSON.stringify(creators));
        }
    }

    function updateVisitorDisplay() {
        const creators = getCreators();
        document.getElementById('visitorCount').textContent = creators.length;
        const visitorListEl = document.getElementById('visitorList');
        visitorListEl.innerHTML = '';
        if (creators.length > 0) {
            creators.forEach(creatorName => {
                const p = document.createElement('p');
                p.textContent = creatorName;
                p.style.margin = '2px 0';
                visitorListEl.appendChild(p);
            });
        } else {
            visitorListEl.innerHTML = 'None yet.';
        }
    }
</script>

</body>
</html>